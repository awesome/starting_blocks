#!/usr/bin/env ruby

require File.expand_path(File.dirname(__FILE__) + '/../lib/starting_blocks.rb')

options = {}

def display value
end

if ARGV.include? '--verbose'
  options[:verbose] = true
end

def run_all_specs options
  specs = Dir['**/*_spec.rb*'].
    select { |f| File.file?(f) }.
    map    { |x| File.expand_path(x) }

  tests = Dir['**/*_test.rb*'].
    select { |f| File.file?(f) }.
    map    { |x| File.expand_path(x) }

  more_tests = Dir['**/test_*.rb*'].
    select { |f| File.file?(f) }.
    map    { |x| File.expand_path(x) }

  files = specs + tests + more_tests
  files = files.flatten

  StartingBlocks::Runner.new(options).run_files files
end

if ARGV.include? '--watch'
  StartingBlocks::Watcher.start_watching Dir, options
else
  run_all_specs options
end
